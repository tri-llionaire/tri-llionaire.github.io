#t-hash 1.1.2 algorithm in python
char = {' ': '169', '$': '157', '(': '144', ',': '156', '0': '140', '4': '160', '8': '180', '<': '149', '@': '142', 'D': '110', 'H':'138', 'L': '106', 'P': '167', 'T': '126', 'X': '195', '\\': '124', '`': '151', 'd': '159', 'h': '114', 'l': '119', 'p': '139', 't': '174', 'x': '103', '|': '138', '#': '192', "'": '186', '+': '163', '/': '176', '3': '191', '7': '100', ';': '191', '?': '115', 'C': '121', 'G': '154', 'K': '161', 'O': '172', 'S': '197', 'W': '162', '[': '182', '_': '114', 'c': '159', 'g': '101', 'k': '159', 'o': '134', 's': '121', 'w': '123', '{': '185', '"': '193', '&': '118', '*': '172', '.': '106', '2': '135', '6': '119', ':': '123', '>': '190', 'B': '114', 'F': '180', 'J': '119', 'N': '121', 'R': '119', 'V': '188', 'Z': '102', '^': '133', 'b': '105', 'f': '190', 'j': '113', 'n': '139', 'r': '162', 'v': '152', 'z': '181', '~': '185', '!': '118', '%': '121', ')': '137', '-': '99', '1': '158', '5': '147', '9': '161', '=': '109', 'A': '106', 'E': '179', 'I': '151', 'M': '195', 'Q': '111', 'U': '100', 'Y': '101', ']': '185', 'a': '174', 'e': '172', 'i': '154', 'm': '198', 'q': '145', 'u': '130', 'y': '170', '}':'148'}
b = raw_input('(roughly) 64, 128, 256, or 512-bit? ')
if b == '64':
    c = 7
elif b == '128':
    c = 13
elif b == '256':
    c = 26
elif b == '512':
    c = 52
else:
    print 'default: 256'
    c = 26
key = raw_input('enter a key (2-100): ')
if 100 <= key >= 2:
    s = raw_input('enter string: ')
    if len(s) > c:
        s = s[:c+1]
    else:
        s = s + (' '*(c-len(s)))
    n = ''
    for a in s:
        if a in char:
            n = n + char[a]
        else:
            n = n + char[' ']
    print hex(int(n)/int(key))[3:]
else:
    pass
